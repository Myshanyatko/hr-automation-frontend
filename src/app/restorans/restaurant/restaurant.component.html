<div class="tui-container">
  <div class="content" *ngIf="restaurant$ | async as rest">
    <div class="title-block">
      <div class="back-and-title">
        <tui-svg
          src="tuiIconBackCircleLarge"
          class="back"
          routerLink="/restaurants"
        ></tui-svg>
        <h2 class="title-rest">{{ rest.name }}</h2>
      </div>
      <div class="icons-faq">
        <tui-svg
          class="icon-faq"
          src="tuiIconEdit"
          [routerLink]="['/restaurants/edit/' + rest.id]"
        ></tui-svg>

        <tui-svg
          class="icon-faq"
          src="tuiIconTrash"
          (click)="deleteRest(rest.id)"
        ></tui-svg>
      </div>
    </div>
    <div class="restaurant">
      <div class="info">
        <div class="address">
          <span class="label">Адрес: </span>
          <span class=""> {{ rest.address }}</span>
        </div>
        <div class="average">
          <span class="label">Средний чек: </span>
          <span class="">
            {{ rest.average != 0 ? rest.average + "₽" : "не оценено" }}</span
          >
        </div>
      </div>
      <div class="map">
        <google-map
          [center]="{ lat: rest.lat, lng: rest.lng }"
          height="280px"
          width="700px"
        >
          <map-marker [position]="{ lat: rest.lat, lng: rest.lng }">
          </map-marker>
        </google-map>
      </div>

      <div class="rating-block">
        <span class="label"></span>
        <p class="">
          Рейтинг:
          {{ rest.rating != 0 ? rest.rating.toFixed(1) : "не оценено" }}
        </p>
        <tui-rating
          [(ngModel)]="rest.rating"
          [readOnly]="true"
          class="tui-rating"
        ></tui-rating>
      </div>

      <!-- ОТЗЫВЫ  -->

      <div class="reviews" *ngIf="reviews$ | async as reviews">
        <h3 class="reviews__title">Отзывы</h3>
        <div class="review" *ngFor="let review of reviews">
          <div class="pic">
            <tui-avatar
              *ngIf="review.userpic"
              class="icon-user-avatar"
              [rounded]="true"
              text="avatar"
              size="m"
              [avatarUrl]="review.userpic || 'tuiIconUser'"
            ></tui-avatar>
            <tui-avatar
              *ngIf="review.userpic == null"
              class="icon-user-avatar"
              [rounded]="true"
              text="avatar"
              size="m"
              avatarUrl="tuiIconUser"
            ></tui-avatar>
          </div>
          <div class="review__content">
            <h4>{{ review.username }}</h4>
            <span *ngIf="review.average != 0">чек: {{ review.average }}₽ </span>
            <div class="">
              <tui-rating
                [(ngModel)]="review.rating"
                [readOnly]="true"
                iconNormal="tuiIconStar"
                iconFilled="tuiIconStarFilled"
                class="tui-rating"
              ></tui-rating>
            </div>
            <p>{{ review.content }}</p>
          </div>
          <tui-svg
            class="icon-faq"
            src="tuiIconTrash"
            (click)="deleteReview(review.id)"
          ></tui-svg>
        </div>
      </div>
    </div>
  </div>
</div>
